{"StartAt": "MAPP_ENTITY_PO_IR_GLPROD", "States": {"MAPP_ENTITY_PO_IR_GLPROD": {"Type": "Pass", "Next": "GLPROD_PO_REQSTN_HDR_FS"}, "GLPROD_PO_REQSTN_HDR_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_REQSTN_HDR_FS", "StringEquals": "Y", "Next": "PASS GLPROD_PO_REQSTN_HDR_FS"}], "Default": "LOAD GLPROD_PO_REQSTN_HDR_FS"}, "LOAD GLPROD_PO_REQSTN_HDR_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_REQSTN_HDR_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_reqstn_hdr_fs_glprod('GLPROD','daily','po_requisition_headers_all','po_reqstn_hdr_fs')", "--query_tag": "MAE-sp_po_reqstn_hdr_fs_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_REQSTN_HDR_FS_FAILED"}], "Next": "PASS GLPROD_PO_REQSTN_HDR_FS"}, "SNS_GLPROD_PO_REQSTN_HDR_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_REQSTN_HDR_FS Source System Failed!"}, "End": false}, "PASS GLPROD_PO_REQSTN_HDR_FS": {"Type": "Pass", "Next": "GLPROD_PO_REQSTN_HDR_F"}, "GLPROD_PO_REQSTN_HDR_F": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_REQSTN_HDR_F", "StringEquals": "Y", "Next": "PASS GLPROD_PO_REQSTN_HDR_F"}], "Default": "LOAD GLPROD_PO_REQSTN_HDR_F"}, "LOAD GLPROD_PO_REQSTN_HDR_F": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_REQSTN_HDR_F", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_reqstn_hdr_f_glprod('GLPROD','daily','po_reqstn_hdr_fs','po_reqstn_hdr_f')", "--query_tag": "MAE-sp_po_reqstn_hdr_f_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_REQSTN_HDR_F_FAILED"}], "Next": "PASS GLPROD_PO_REQSTN_HDR_F"}, "SNS_GLPROD_PO_REQSTN_HDR_F_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_REQSTN_HDR_F Source System Failed!"}, "End": false}, "PASS GLPROD_PO_REQSTN_HDR_F": {"Type": "Pass", "Next": "GLPROD_PO_HEDR_FS"}, "GLPROD_PO_HEDR_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_HEDR_FS", "StringEquals": "Y", "Next": "PASS GLPROD_PO_HEDR_FS"}], "Default": "LOAD GLPROD_PO_HEDR_FS"}, "LOAD GLPROD_PO_HEDR_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_HEDR_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_hedr_fs_glprod()", "--query_tag": "MAE-sp_po_hedr_fs_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_HEDR_FS_FAILED"}], "Next": "PASS GLPROD_PO_HEDR_FS"}, "SNS_GLPROD_PO_HEDR_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_HEDR_FS Source System Failed!"}, "End": false}, "PASS GLPROD_PO_HEDR_FS": {"Type": "Pass", "Next": "GLPROD_PO_HEDR_F"}, "GLPROD_PO_HEDR_F": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_HEDR_F", "StringEquals": "Y", "Next": "PASS GLPROD_PO_HEDR_F"}], "Default": "LOAD GLPROD_PO_HEDR_F"}, "LOAD GLPROD_PO_HEDR_F": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_HEDR_F", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_hedr_f_glprod()", "--query_tag": "MAE-sp_po_hedr_f_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_HEDR_F_FAILED"}], "Next": "PASS GLPROD_PO_HEDR_F"}, "SNS_GLPROD_PO_HEDR_F_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_HEDR_F Source System Failed!"}, "End": false}, "PASS GLPROD_PO_HEDR_F": {"Type": "Pass", "Next": "GLPROD_PO_REQSTN_LIN_FS"}, "GLPROD_PO_REQSTN_LIN_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_REQSTN_LIN_FS", "StringEquals": "Y", "Next": "PASS GLPROD_PO_REQSTN_LIN_FS"}], "Default": "LOAD GLPROD_PO_REQSTN_LIN_FS"}, "LOAD GLPROD_PO_REQSTN_LIN_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_REQSTN_LIN_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_reqstn_lin_fs_glprod('GLPROD','DAILY','po_requisition_lines_all','po_reqstn_lin_fs')", "--query_tag": "MAE-sp_po_reqstn_lin_fs_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_REQSTN_LIN_FS_FAILED"}], "Next": "PASS GLPROD_PO_REQSTN_LIN_FS"}, "SNS_GLPROD_PO_REQSTN_LIN_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_REQSTN_LIN_FS Source System Failed!"}, "End": false}, "PASS GLPROD_PO_REQSTN_LIN_FS": {"Type": "Pass", "Next": "GLPROD_PO_REQSTN_LIN_F"}, "GLPROD_PO_REQSTN_LIN_F": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_REQSTN_LIN_F", "StringEquals": "Y", "Next": "PASS GLPROD_PO_REQSTN_LIN_F"}], "Default": "LOAD GLPROD_PO_REQSTN_LIN_F"}, "LOAD GLPROD_PO_REQSTN_LIN_F": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_REQSTN_LIN_F", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_reqstn_lin_f_glprod('GLPROD','DAILY','po_reqstn_lin_fs','po_reqstn_lin_f')", "--query_tag": "MAE-sp_po_reqstn_lin_f_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_REQSTN_LIN_F_FAILED"}], "Next": "PASS GLPROD_PO_REQSTN_LIN_F"}, "SNS_GLPROD_PO_REQSTN_LIN_F_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_REQSTN_LIN_F Source System Failed!"}, "End": false}, "PASS GLPROD_PO_REQSTN_LIN_F": {"Type": "Pass", "Next": "GLPROD_PO_LIN_FS"}, "GLPROD_PO_LIN_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_LIN_FS", "StringEquals": "Y", "Next": "PASS GLPROD_PO_LIN_FS"}], "Default": "LOAD GLPROD_PO_LIN_FS"}, "LOAD GLPROD_PO_LIN_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_LIN_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_lin_fs_glprod('GLPROD','DAILY','PO_LINES_ALL','po_lin_fs')", "--query_tag": "MAE-sp_po_lin_fs_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_LIN_FS_FAILED"}], "Next": "PASS GLPROD_PO_LIN_FS"}, "SNS_GLPROD_PO_LIN_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_LIN_FS Source System Failed!"}, "End": false}, "PASS GLPROD_PO_LIN_FS": {"Type": "Pass", "Next": "GLPROD_PO_LIN_F"}, "GLPROD_PO_LIN_F": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_LIN_F", "StringEquals": "Y", "Next": "PASS GLPROD_PO_LIN_F"}], "Default": "LOAD GLPROD_PO_LIN_F"}, "LOAD GLPROD_PO_LIN_F": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_LIN_F", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_lin_f_glprod('GLPROD','DAILY','po_lin_fs','po_lin_f')", "--query_tag": "MAE-sp_po_lin_f_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_LIN_F_FAILED"}], "Next": "PASS GLPROD_PO_LIN_F"}, "SNS_GLPROD_PO_LIN_F_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_LIN_F Source System Failed!"}, "End": false}, "PASS GLPROD_PO_LIN_F": {"Type": "Pass", "Next": "GLPROD_PO_LIN_LOC_FS"}, "GLPROD_PO_LIN_LOC_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_LIN_LOC_FS", "StringEquals": "Y", "Next": "PASS GLPROD_PO_LIN_LOC_FS"}], "Default": "LOAD GLPROD_PO_LIN_LOC_FS"}, "LOAD GLPROD_PO_LIN_LOC_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_LIN_LOC_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_lin_loc_fs_glprod('GLPROD','DAILY','PO_LINE_LOCATIONS_ALL~PO_LIN_LOC_FS~GLPROD','PO_LIN_LOC_FS')", "--query_tag": "MAE-sp_po_lin_loc_fs_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_LIN_LOC_FS_FAILED"}], "Next": "PASS GLPROD_PO_LIN_LOC_FS"}, "SNS_GLPROD_PO_LIN_LOC_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_LIN_LOC_FS Source System Failed!"}, "End": false}, "PASS GLPROD_PO_LIN_LOC_FS": {"Type": "Pass", "Next": "GLPROD_PO_LIN_LOC_F"}, "GLPROD_PO_LIN_LOC_F": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_LIN_LOC_F", "StringEquals": "Y", "Next": "PASS GLPROD_PO_LIN_LOC_F"}], "Default": "LOAD GLPROD_PO_LIN_LOC_F"}, "LOAD GLPROD_PO_LIN_LOC_F": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_LIN_LOC_F", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_lin_loc_f_glprod('GLPROD','DAILY','PO_LINE_LOCATIONS_ALL~PO_LIN_LOC_FS~GLPROD','PO_LIN_LOC_F')", "--query_tag": "MAE-sp_po_lin_loc_f_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_LIN_LOC_F_FAILED"}], "Next": "PASS GLPROD_PO_LIN_LOC_F"}, "SNS_GLPROD_PO_LIN_LOC_F_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_LIN_LOC_F Source System Failed!"}, "End": false}, "PASS GLPROD_PO_LIN_LOC_F": {"Type": "Pass", "Next": "GLPROD_PO_REQ_DIST_FS"}, "GLPROD_PO_REQ_DIST_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_REQ_DIST_FS", "StringEquals": "Y", "Next": "PASS GLPROD_PO_REQ_DIST_FS"}], "Default": "LOAD GLPROD_PO_REQ_DIST_FS"}, "LOAD GLPROD_PO_REQ_DIST_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_REQ_DIST_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_po_req_dist_fs_glprod()", "--query_tag": "MAE-sp_po_req_dist_fs_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_REQ_DIST_FS_FAILED"}], "Next": "PASS GLPROD_PO_REQ_DIST_FS"}, "SNS_GLPROD_PO_REQ_DIST_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_REQ_DIST_FS Source System Failed!"}, "End": false}, "PASS GLPROD_PO_REQ_DIST_FS": {"Type": "Pass", "Next": "GLPROD_PO_DIST_FS"}, "GLPROD_PO_DIST_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_DIST_FS", "StringEquals": "Y", "Next": "PASS GLPROD_PO_DIST_FS"}], "Default": "LOAD GLPROD_PO_DIST_FS"}, "LOAD GLPROD_PO_DIST_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_DIST_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "HDL_SERVICES_SP.SP_PO_DIST_FS_GLPROD('GLPROD','DAILY','po_distributions_all~po_dist_fs~GLPROD','po_dist_fs')", "--query_tag": "MAE-SP_PO_DIST_FS_GLPROD", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_DIST_FS_FAILED"}], "Next": "PASS GLPROD_PO_DIST_FS"}, "SNS_GLPROD_PO_DIST_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_DIST_FS Source System Failed!"}, "End": false}, "PASS GLPROD_PO_DIST_FS": {"Type": "Pass", "Next": "GLPROD_PO_DIST_F"}, "GLPROD_PO_DIST_F": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PO_DIST_F", "StringEquals": "Y", "Next": "PASS GLPROD_PO_DIST_F"}], "Default": "LOAD GLPROD_PO_DIST_F"}, "LOAD GLPROD_PO_DIST_F": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PO_DIST_F", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "HDL_SERVICES_SP.SP_PO_DIST_F_GLPROD('GLPROD','DAILY','po_distributions_all~po_dist_fs~GLPROD','po_dist_f')", "--query_tag": "MAE-SP_PO_DIST_F_GLPROD", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PO_DIST_F_FAILED"}], "Next": "PASS GLPROD_PO_DIST_F"}, "SNS_GLPROD_PO_DIST_F_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_PO_DIST_F Source System Failed!"}, "End": false}, "PASS GLPROD_PO_DIST_F": {"Type": "Pass", "Next": "GLPROD_ORDR_REQSTN_PO_AS"}, "GLPROD_ORDR_REQSTN_PO_AS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_ORDR_REQSTN_PO_AS", "StringEquals": "Y", "Next": "PASS GLPROD_ORDR_REQSTN_PO_AS"}], "Default": "LOAD GLPROD_ORDR_REQSTN_PO_AS"}, "LOAD GLPROD_ORDR_REQSTN_PO_AS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_ORDR_REQSTN_PO_AS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_ordr_reqstn_po_as_glprod()", "--query_tag": "MAE-p_ordr_reqstn_po_as_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_ORDR_REQSTN_PO_AS_FAILED"}], "Next": "PASS GLPROD_ORDR_REQSTN_PO_AS"}, "SNS_GLPROD_ORDR_REQSTN_PO_AS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_ORDR_REQSTN_PO_AS Source System Failed!"}, "End": false}, "PASS GLPROD_ORDR_REQSTN_PO_AS": {"Type": "Pass", "Next": "GLPROD_ORDR_REQSTN_PO_A"}, "GLPROD_ORDR_REQSTN_PO_A": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_ORDR_REQSTN_PO_A", "StringEquals": "Y", "Next": "PASS GLPROD_ORDR_REQSTN_PO_A"}], "Default": "LOAD GLPROD_ORDR_REQSTN_PO_A"}, "LOAD GLPROD_ORDR_REQSTN_PO_A": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_ORDR_REQSTN_PO_A", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_ordr_reqstn_po_a_glprod()", "--query_tag": "MAE-sp_ordr_reqstn_po_a_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_ORDR_REQSTN_PO_A_FAILED"}], "Next": "PASS GLPROD_ORDR_REQSTN_PO_A"}, "SNS_GLPROD_ORDR_REQSTN_PO_A_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_ORDR_REQSTN_PO_A Source System Failed!"}, "End": false}, "PASS GLPROD_ORDR_REQSTN_PO_A": {"Type": "Pass", "Next": "GLPROD_RCV_TRANS_FS"}, "GLPROD_RCV_TRANS_FS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_RCV_TRANS_FS", "StringEquals": "Y", "Next": "PASS GLPROD_RCV_TRANS_FS"}], "Default": "LOAD GLPROD_RCV_TRANS_FS"}, "LOAD GLPROD_RCV_TRANS_FS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_RCV_TRANS_FS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "HDL_SERVICES_SP.SP_RCV_TRANS_FS_GLPROD('GLPROD','DAILY','RCV_TRANSACTIONS~RCV_TRANS_FS~GLPROD','RCV_TRANS_FS')", "--query_tag": "MAE-SP_RCV_TRANS_FS_GLPROD", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_RCV_TRANS_FS_FAILED"}], "Next": "PASS GLPROD_RCV_TRANS_FS"}, "SNS_GLPROD_RCV_TRANS_FS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_RCV_TRANS_FS Source System Failed!"}, "End": false}, "PASS GLPROD_RCV_TRANS_FS": {"Type": "Pass", "Next": "GLPROD_RCV_TRANS_F"}, "GLPROD_RCV_TRANS_F": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_RCV_TRANS_F", "StringEquals": "Y", "Next": "PASS GLPROD_RCV_TRANS_F"}], "Default": "LOAD GLPROD_RCV_TRANS_F"}, "LOAD GLPROD_RCV_TRANS_F": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_RCV_TRANS_F", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "HDL_SERVICES_SP.SP_RCV_TRANS_F_GLPROD('GLPROD','DAILY','RCV_TRANSACTIONS~RCV_TRANS_FS~GLPROD','RCV_TRANS_F')", "--query_tag": "MAE-SP_RCV_TRANS_F_GLPROD", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_RCV_TRANS_F_FAILED"}], "Next": "PASS GLPROD_RCV_TRANS_F"}, "SNS_GLPROD_RCV_TRANS_F_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for GLPROD_RCV_TRANS_F Source System Failed!"}, "End": false}, "PASS GLPROD_RCV_TRANS_F": {"Type": "Pass", "Next": "GLPROD_PART_FAMILY_DS"}, "GLPROD_PART_FAMILY_DS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GLPROD_PART_FAMILY_DS", "StringEquals": "Y", "Next": "SKIP GLPROD_PART_FAMILY_DS"}], "Default": "LOAD GLPROD_PART_FAMILY_DS"}, "LOAD GLPROD_PART_FAMILY_DS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.GLPROD_PART_FAMILY_DS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_part_family_ds()", "--query_tag": "MAE-sp_part_family_ds", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_GLPROD_PART_FAMILY_DS_FAILED"}], "Next": "SKIP GLPROD_PART_FAMILY_DS"}, "SNS_GLPROD_PART_FAMILY_DS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS GLUE SHELL JOB FOR GLPROD_PART_FAMILY_DS FAILED!"}, "End": false}, "SKIP GLPROD_PART_FAMILY_DS": {"Type": "Pass", "Next": "Completed"}, "Completed": {"Type": "Pass", "Next": "SNS_MAPP_ENTITY_PO_IR_GLPROD_SUCCESS"}, "SNS_MAPP_ENTITY_PO_IR_GLPROD_SUCCESS": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for MAPP_ENTITY_PO_IR_GLPROD completed successfully!!"}}, "End": true}}}