{"StartAt": "START SIT COMPACTION JOBS", "States": {"START SIT COMPACTION JOBS": {"Type": "Pass", "InputPath": "$", "ResultPath": "$", "Next": "GET LAMBDA"}, "GET LAMBDA": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GET_LAMBDA", "StringEquals": "Y", "Next": "SKIP GET LAMBDA"}], "Default": "EXECUTE GET LAMBDA"}, "EXECUTE GET LAMBDA": {"Type": "Task", "InputPath": "$", "ResultPath": "$.INPUT.BATCH_NUMBER", "Resource": "arn:aws:lambda:us-east-1:541574621075:function:ddb_get_lambda", "Next": "SKIP GET LAMBDA"}, "SKIP GET LAMBDA": {"Type": "Pass", "InputPath": "$", "ResultPath": "$.SKIP_LAMBDA", "Next": "StartParallel"}, "StartParallel": {"Type": "Parallel", "Next": "Completed", "ResultPath": "$.parallelResult", "Branches": [{"StartAt": "SIT_S_INVC_ITM_DTL", "States": {"SIT_S_INVC_ITM_DTL": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_invc_itm_dtl", "StringEquals": "Y", "Next": "PASS SIT_S_INVC_ITM_DTL"}], "Default": "LOAD SIT_S_INVC_ITM_DTL"}, "LOAD SIT_S_INVC_ITM_DTL": {"Type": "Task", "ResultPath": "$.SIT_S_INVC_ITM_DTL", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_invc_itm_dtl", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_INVC_ITM_DTL_FAILED"}], "Next": "PASS SIT_S_INVC_ITM_DTL"}, "SNS_SIT_S_INVC_ITM_DTL_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_INVC_ITM_DTL Failed!"}, "Next": "SIT_S_INVC_ITM_DTL_ACTIVITY"}, "SIT_S_INVC_ITM_DTL_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_INVC_ITM_DTL_ACTIVITY", "End": true}, "PASS SIT_S_INVC_ITM_DTL": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_ENTL_ACT_PART", "States": {"SIT_S_ENTL_ACT_PART": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_entl_act_part", "StringEquals": "Y", "Next": "PASS SIT_S_ENTL_ACT_PART"}], "Default": "LOAD SIT_S_ENTL_ACT_PART"}, "LOAD SIT_S_ENTL_ACT_PART": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "ResultPath": "$.SIT_S_ENTL_ACT_PART", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_entl_act_part", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_ENTL_ACT_PART_FAILED"}], "Next": "PASS SIT_S_ENTL_ACT_PART"}, "SNS_SIT_S_ENTL_ACT_PART_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SIT_S_ENTL_ACT_PART Failed!"}, "Next": "SIT_S_ENTL_ACT_PART_ACTIVITY"}, "SIT_S_ENTL_ACT_PART_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_ENTL_ACT_PART_ACTIVITY", "End": true}, "PASS SIT_S_ENTL_ACT_PART": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_ENTL_ACT_LBR", "States": {"SIT_S_ENTL_ACT_LBR": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_entl_act_lbr", "StringEquals": "Y", "Next": "PASS SIT_S_ENTL_ACT_LBR"}], "Default": "LOAD SIT_S_ENTL_ACT_LBR"}, "LOAD SIT_S_ENTL_ACT_LBR": {"Type": "Task", "ResultPath": "$.SIT_S_ENTL_ACT_LBR", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_entl_act_lbr", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_ENTL_ACT_LBR_FAILED"}], "Next": "PASS SIT_S_ENTL_ACT_LBR"}, "SNS_SIT_S_ENTL_ACT_LBR_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_ENTL_ACT_LBR Failed!"}, "Next": "SIT_S_ENTL_ACT_LBR_ACTIVITY"}, "SIT_S_ENTL_ACT_LBR_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_ENTL_ACT_LBR_ACTIVITY", "End": true}, "PASS SIT_S_ENTL_ACT_LBR": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_ACT_PRDINT", "States": {"SIT_S_ACT_PRDINT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_act_prdint", "StringEquals": "Y", "Next": "PASS SIT_S_ACT_PRDINT"}], "Default": "LOAD SIT_S_ACT_PRDINT"}, "LOAD SIT_S_ACT_PRDINT": {"Type": "Task", "ResultPath": "$.SIT_S_ACT_PRDINT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_act_prdint", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_ACT_PRDINT_FAILED"}], "Next": "PASS SIT_S_ACT_PRDINT"}, "SNS_SIT_S_ACT_PRDINT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_ACT_PRDINT Failed!"}, "Next": "SIT_S_ACT_PRDINT_ACTIVITY"}, "SIT_S_ACT_PRDINT_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_ACT_PRDINT_ACTIVITY", "End": true}, "PASS SIT_S_ACT_PRDINT": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_NOTE_ACT", "States": {"SIT_S_NOTE_ACT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_note_act", "StringEquals": "Y", "Next": "PASS SIT_S_NOTE_ACT"}], "Default": "LOAD SIT_S_NOTE_ACT"}, "LOAD SIT_S_NOTE_ACT": {"Type": "Task", "ResultPath": "$.SIT_S_NOTE_ACT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_note_act", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_NOTE_ACT_FAILED"}], "Next": "PASS SIT_S_NOTE_ACT"}, "SNS_SIT_S_NOTE_ACT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_NOTE_ACT Failed!"}, "Next": "SIT_S_NOTE_ACT_ACTIVITY"}, "SIT_S_NOTE_ACT_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_NOTE_ACT_ACTIVITY", "End": true}, "PASS SIT_S_NOTE_ACT": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_PROD_RECMNDTN", "States": {"SIT_S_PROD_RECMNDTN": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_prod_recmndtn", "StringEquals": "Y", "Next": "PASS SIT_S_PROD_RECMNDTN"}], "Default": "LOAD SIT_S_PROD_RECMNDTN"}, "LOAD SIT_S_PROD_RECMNDTN": {"Type": "Task", "ResultPath": "$.SIT_S_PROD_RECMNDTN", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_prod_recmndtn", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_PROD_RECMNDTN_FAILED"}], "Next": "PASS SIT_S_PROD_RECMNDTN"}, "SNS_SIT_S_PROD_RECMNDTN_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_PROD_RECMNDTN Failed!"}, "Next": "SIT_S_PROD_RECMNDTN_ACTIVITY"}, "SIT_S_PROD_RECMNDTN_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_PROD_RECMNDTN_ACTIVITY", "End": true}, "PASS SIT_S_PROD_RECMNDTN": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_EMP_PER", "States": {"SIT_S_EMP_PER": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_emp_per", "StringEquals": "Y", "Next": "PASS SIT_S_EMP_PER"}], "Default": "LOAD SIT_S_EMP_PER"}, "LOAD SIT_S_EMP_PER": {"Type": "Task", "ResultPath": "$.SIT_S_EMP_PER", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_emp_per", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_EMP_PER_FAILED"}], "Next": "PASS SIT_S_EMP_PER"}, "SNS_SIT_S_EMP_PER_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_EMP_PER Failed!"}, "Next": "SIT_S_EMP_PER_ACTIVITY"}, "SIT_S_EMP_PER_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_EMP_PER_ACTIVITY", "End": true}, "PASS SIT_S_EMP_PER": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_PARTY", "States": {"SIT_S_PARTY": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_party", "StringEquals": "Y", "Next": "PASS SIT_S_PARTY"}], "Default": "LOAD SIT_S_PARTY"}, "LOAD SIT_S_PARTY": {"Type": "Task", "ResultPath": "$.SIT_S_PARTY", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_party", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_PARTY_FAILED"}], "Next": "PASS SIT_S_PARTY"}, "SNS_SIT_S_PARTY_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_PARTY Failed!"}, "Next": "SIT_S_PARTY_ACTIVITY"}, "SIT_S_PARTY_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_PARTY_ACTIVITY", "End": true}, "PASS SIT_S_PARTY": {"Type": "Pass", "End": true}}}]}, "Completed": {"Type": "Pass", "InputPath": "$.SKIP_LAMBDA", "Next": "SNS_SIT_COMPACTION_SUCCESS"}, "SNS_SIT_COMPACTION_SUCCESS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.snsResult", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for COMPACTION_SIT completed successfully!!"}}, "End": true}}}