{"StartAt": "MAPP_ENTITY_FLAT_FILE", "States": {"MAPP_ENTITY_FLAT_FILE": {"Type": "Pass", "Next": "StartParallel"}, "StartParallel": {"Type": "Parallel", "Next": "FLATFILE_ORG_REGION_DH", "ResultPath": "$.parallelResult", "Branches": [{"StartAt": "FLATFILE_INV_ITM_TECH_OBSO_DS", "States": {"FLATFILE_INV_ITM_TECH_OBSO_DS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.FLATFILE_INV_ITM_TECH_OBSO_DS", "StringEquals": "Y", "Next": "PASS FLATFILE_INV_ITM_TECH_OBSO_DS"}], "Default": "LOAD FLATFILE_INV_ITM_TECH_OBSO_DS"}, "LOAD FLATFILE_INV_ITM_TECH_OBSO_DS": {"Type": "Task", "ResultPath": "$.FLATFILE_INV_ITM_TECH_OBSO_DS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_inv_itm_tech_obso_ds_flat_file()", "--query_tag": "MAE-itm_tech_obso_ds_flat_file", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_FLATFILE_INV_ITM_TECH_OBSO_DS_FAILED"}], "Next": "PASS FLATFILE_INV_ITM_TECH_OBSO_DS"}, "SNS_FLATFILE_INV_ITM_TECH_OBSO_DS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_FLATFILE_INV_ITM_TECH_OBSO_DS Failed!"}, "Next": "FLATFILE_INV_ITM_TECH_OBSO_DS_ACTIVITY"}, "FLATFILE_INV_ITM_TECH_OBSO_DS_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:MAPP_ENTITY_FLATFILE_INV_ITM_TECH_OBSO_DS_ACTIVITY", "End": true}, "PASS FLATFILE_INV_ITM_TECH_OBSO_DS": {"Type": "Pass", "End": true}}}, {"StartAt": "FLATFILE_BO_TARGET_LOOKUP_DS", "States": {"FLATFILE_BO_TARGET_LOOKUP_DS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.FLATFILE_BO_TARGET_LOOKUP_DS", "StringEquals": "Y", "Next": "PASS FLATFILE_BO_TARGET_LOOKUP_DS"}], "Default": "LOAD FLATFILE_BO_TARGET_LOOKUP_DS"}, "LOAD FLATFILE_BO_TARGET_LOOKUP_DS": {"Type": "Task", "ResultPath": "$.FLATFILE_BO_TARGET_LOOKUP_DS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_bo_target_lookup_ds()", "--query_tag": "MAE-sp_bo_target_lookup_ds", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_FLATFILE_BO_TARGET_LOOKUP_DS_FAILED"}], "Next": "PASS FLATFILE_BO_TARGET_LOOKUP_DS"}, "SNS_FLATFILE_BO_TARGET_LOOKUP_DS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SNS_FLATFILE_BO_TARGET_LOOKUP_DS Failed!"}, "Next": "FLATFILE_BO_TARGET_LOOKUP_DS_ACTIVITY"}, "FLATFILE_BO_TARGET_LOOKUP_DS_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:MAPP_ENTITY_FLATFILE_BO_TARGET_LOOKUP_DS_ACTIVITY", "End": true}, "PASS FLATFILE_BO_TARGET_LOOKUP_DS": {"Type": "Pass", "End": true}}}, {"StartAt": "FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM", "States": {"FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM", "StringEquals": "Y", "Next": "PASS FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM"}], "Default": "LOAD FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM"}, "LOAD FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM": {"Type": "Task", "ResultPath": "$.FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_prt_vendr_item_rel_as_SPM()", "--query_tag": "MAE-_prt_vendr_item_rel_as_SPM", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM_FAILED"}], "Next": "PASS FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM"}, "SNS_FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM Failed!"}, "Next": "FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM_ACTIVITY"}, "FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:MAPP_ENTITY_FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM_ACTIVITY", "End": true}, "PASS FLATFILE_PRT_VENDR_ITEM_REL_AS_SPM": {"Type": "Pass", "End": true}}}, {"StartAt": "FLATFILE_ITM_COUNTRY_RESTRCTN_DS", "States": {"FLATFILE_ITM_COUNTRY_RESTRCTN_DS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.FLATFILE_ITM_COUNTRY_RESTRCTN_DS", "StringEquals": "Y", "Next": "PASS FLATFILE_ITM_COUNTRY_RESTRCTN_DS"}], "Default": "LOAD FLATFILE_ITM_COUNTRY_RESTRCTN_DS"}, "LOAD FLATFILE_ITM_COUNTRY_RESTRCTN_DS": {"Type": "Task", "ResultPath": "$.FLATFILE_ITM_COUNTRY_RESTRCTN_DS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_Itm_country_restrctn_DS_flat_file()", "--query_tag": "MAE-ntry_restrctn_DS_flat_file", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_FLATFILE_ITM_COUNTRY_RESTRCTN_DS_FAILED"}], "Next": "PASS FLATFILE_ITM_COUNTRY_RESTRCTN_DS"}, "SNS_FLATFILE_ITM_COUNTRY_RESTRCTN_DS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_FLATFILE_ITM_COUNTRY_RESTRCTN_DS_FAILED Failed!"}, "Next": "FLATFILE_ITM_COUNTRY_RESTRCTN_DS_ACTIVITY"}, "FLATFILE_ITM_COUNTRY_RESTRCTN_DS_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:MAPP_ENTITY_FLATFILE_ITM_COUNTRY_RESTRCTN_DS_ACTIVITY", "End": true}, "PASS FLATFILE_ITM_COUNTRY_RESTRCTN_DS": {"Type": "Pass", "End": true}}}, {"StartAt": "FLATFILE_ORG_REGION_DHS", "States": {"FLATFILE_ORG_REGION_DHS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.FLATFILE_ORG_REGION_DHS", "StringEquals": "Y", "Next": "PASS FLATFILE_ORG_REGION_DHS"}], "Default": "LOAD FLATFILE_ORG_REGION_DHS"}, "LOAD FLATFILE_ORG_REGION_DHS": {"Type": "Task", "ResultPath": "$.FLATFILE_ORG_REGION_DHS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_org_region_dhs_glprod('FLATFILE','INSERT','pole_region_hierarchy_flat_file','org_region_dhs')", "--query_tag": "MAE-sp_org_region_dhs_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_FLATFILE_ORG_REGION_DHS_FAILED"}], "Next": "PASS FLATFILE_ORG_REGION_DHS"}, "SNS_FLATFILE_ORG_REGION_DHS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_FLATFILE_ORG_REGION_DHS Failed!"}, "Next": "FLATFILE_ORG_REGION_DHS_ACTIVITY"}, "FLATFILE_ORG_REGION_DHS_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:MAPP_ENTITY_FLATFILE_ORG_REGION_DHS_ACTIVITY", "End": true}, "PASS FLATFILE_ORG_REGION_DHS": {"Type": "Pass", "End": true}}}]}, "FLATFILE_ORG_REGION_DH": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.FLATFILE_ORG_REGION_DH", "StringEquals": "Y", "Next": "PASS FLATFILE_ORG_REGION_DH"}], "Default": "LOAD FLATFILE_ORG_REGION_DH"}, "LOAD FLATFILE_ORG_REGION_DH": {"Type": "Task", "InputPath": "$", "ResultPath": "$.FLATFILE_ORG_REGION_DH", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_entity_cds_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_sp.sp_org_region_dh_glprod('FLATFILE','INSERT','org_region_dhs','org_region_dh')", "--query_tag": "MAE-sp_org_region_dh_glprod", "--stats_flg": "Y"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_FLATFILE_ORG_REGION_DH_FAILED"}], "Next": "PASS FLATFILE_ORG_REGION_DH"}, "SNS_FLATFILE_ORG_REGION_DH_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS glue job for FLATFILE_ORG_REGION_DH Source System Failed!"}, "End": false}, "PASS FLATFILE_ORG_REGION_DH": {"Type": "Pass", "Next": "Completed"}, "Completed": {"Type": "Pass", "Next": "SNS_MAPP_ENTITY_FLAT_FILE_SUCCESS"}, "SNS_MAPP_ENTITY_FLAT_FILE_SUCCESS": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for MAPP_ENTITY_FLAT_FILE completed successfully!!"}}, "End": true}}}