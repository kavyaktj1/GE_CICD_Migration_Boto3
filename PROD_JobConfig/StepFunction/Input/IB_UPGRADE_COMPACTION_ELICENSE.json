{"StartAt": "START IB_UPGRADE_COMPACTION_ELICENSE JOBS", "States": {"START IB_UPGRADE_COMPACTION_ELICENSE JOBS": {"Type": "Pass", "InputPath": "$", "ResultPath": "$", "Next": "GET LAMBDA"}, "GET LAMBDA": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GET_LAMBDA", "StringEquals": "Y", "Next": "SKIP GET LAMBDA"}], "Default": "EXECUTE GET LAMBDA"}, "EXECUTE GET LAMBDA": {"Type": "Task", "InputPath": "$", "ResultPath": "$.INPUT.BATCH_NUMBER", "Resource": "arn:aws:lambda:us-east-1:541574621075:function:ddb_get_lambda", "Next": "SKIP GET LAMBDA"}, "SKIP GET LAMBDA": {"Type": "Pass", "InputPath": "$", "ResultPath": "$.SKIP_LAMBDA", "Next": "StartParallel"}, "StartParallel": {"Type": "Parallel", "Next": "Completed", "ResultPath": "$.parallelResult", "Branches": [{"StartAt": "ELICENSE_EL_LICENSES", "States": {"ELICENSE_EL_LICENSES": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_elicense_el_licenses", "StringEquals": "Y", "Next": "PASS ELICENSE_EL_LICENSES"}], "Default": "LOAD ELICENSE_EL_LICENSES"}, "LOAD ELICENSE_EL_LICENSES": {"Type": "Task", "ResultPath": "$.ELICENSE_EL_LICENSES", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_elicense_el_licenses", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_ELICENSE_EL_LICENSES_FAILED"}], "Next": "PASS ELICENSE_EL_LICENSES"}, "SNS_ELICENSE_EL_LICENSES_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_ELICENSE_EL_LICENSES Failed!"}, "Next": "ELICENSE_EL_LICENSES_ACTIVITY"}, "ELICENSE_EL_LICENSES_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_ELICENSE_EL_LICENSES_ACTIVITY", "End": true}, "PASS ELICENSE_EL_LICENSES": {"Type": "Pass", "End": true}}}, {"StartAt": "ELICENSE_EL_REQUEST_TYP", "States": {"ELICENSE_EL_REQUEST_TYP": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_elicense_el_request_typ", "StringEquals": "Y", "Next": "PASS ELICENSE_EL_REQUEST_TYP"}], "Default": "LOAD ELICENSE_EL_REQUEST_TYP"}, "LOAD ELICENSE_EL_REQUEST_TYP": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "ResultPath": "$.ELICENSE_EL_REQUEST_TYP", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_ELICENSE_EL_REQUEST_TYP", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_ELICENSE_EL_REQUEST_TYP_FAILED"}], "Next": "PASS ELICENSE_EL_REQUEST_TYP"}, "SNS_ELICENSE_EL_REQUEST_TYP_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for ELICENSE_EL_REQUEST_TYP Failed!"}, "Next": "ELICENSE_EL_REQUEST_TYP_ACTIVITY"}, "ELICENSE_EL_REQUEST_TYP_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_ELICENSE_EL_REQUEST_TYP_ACTIVITY", "End": true}, "PASS ELICENSE_EL_REQUEST_TYP": {"Type": "Pass", "End": true}}}, {"StartAt": "ELICENSE_ES_ORIGINATOR_TYP", "States": {"ELICENSE_ES_ORIGINATOR_TYP": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_elicense_es_originator_typ", "StringEquals": "Y", "Next": "PASS ELICENSE_ES_ORIGINATOR_TYP"}], "Default": "LOAD ELICENSE_ES_ORIGINATOR_TYP"}, "LOAD ELICENSE_ES_ORIGINATOR_TYP": {"Type": "Task", "ResultPath": "$.ELICENSE_ES_ORIGINATOR_TYP", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_elicense_es_originator_typ", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_ELICENSE_ES_ORIGINATOR_TYP_FAILED"}], "Next": "PASS ELICENSE_ES_ORIGINATOR_TYP"}, "SNS_ELICENSE_ES_ORIGINATOR_TYP_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_ELICENSE_ES_ORIGINATOR_TYP Failed!"}, "Next": "ELICENSE_ES_ORIGINATOR_TYP_ACTIVITY"}, "ELICENSE_ES_ORIGINATOR_TYP_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_ELICENSE_ES_ORIGINATOR_TYP_ACTIVITY", "End": true}, "PASS ELICENSE_ES_ORIGINATOR_TYP": {"Type": "Pass", "End": true}}}, {"StartAt": "ELICENSE_ES_PRODUCT", "States": {"ELICENSE_ES_PRODUCT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_elicense_es_product", "StringEquals": "Y", "Next": "PASS ELICENSE_ES_PRODUCT"}], "Default": "LOAD ELICENSE_ES_PRODUCT"}, "LOAD ELICENSE_ES_PRODUCT": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "ResultPath": "$.ELICENSE_ES_PRODUCT", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_elicense_es_product", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_ELICENSE_ES_PRODUCT_FAILED"}], "Next": "PASS ELICENSE_ES_PRODUCT"}, "SNS_ELICENSE_ES_PRODUCT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for ELICENSE_ES_PRODUCT Failed!"}, "Next": "ELICENSE_ES_PRODUCT_ACTIVITY"}, "ELICENSE_ES_PRODUCT_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_ELICENSE_ES_PRODUCT_ACTIVITY", "End": true}, "PASS ELICENSE_ES_PRODUCT": {"Type": "Pass", "End": true}}}, {"StartAt": "ELICENSE_PACKAGES", "States": {"ELICENSE_PACKAGES": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_elicense_packages", "StringEquals": "Y", "Next": "PASS ELICENSE_PACKAGES"}], "Default": "LOAD ELICENSE_PACKAGES"}, "LOAD ELICENSE_PACKAGES": {"Type": "Task", "ResultPath": "$.ELICENSE_PACKAGES", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_elicense_packages", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_ELICENSE_PACKAGES_FAILED"}], "Next": "PASS ELICENSE_PACKAGES"}, "SNS_ELICENSE_PACKAGES_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_ELICENSE_PACKAGES Failed!"}, "Next": "ELICENSE_PACKAGES_ACTIVITY"}, "ELICENSE_PACKAGES_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_ELICENSE_PACKAGES_ACTIVITY", "End": true}, "PASS ELICENSE_PACKAGES": {"Type": "Pass", "End": true}}}]}, "Completed": {"Type": "Pass", "InputPath": "$.SKIP_LAMBDA", "Next": "SNS_IB_UPGRADE_COMPACTION_ELICENSE_SUCCESS"}, "SNS_IB_UPGRADE_COMPACTION_ELICENSE_SUCCESS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.snsResult", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for IB_UPGRADE_COMPACTION_ELICENSE completed successfully!!"}}, "End": true}}}