{"StartAt": "START SIT COMPACTION JOBS", "States": {"START SIT COMPACTION JOBS": {"Type": "Pass", "InputPath": "$", "ResultPath": "$", "Next": "GET LAMBDA"}, "GET LAMBDA": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GET_LAMBDA", "StringEquals": "Y", "Next": "SKIP GET LAMBDA"}], "Default": "EXECUTE GET LAMBDA"}, "EXECUTE GET LAMBDA": {"Type": "Task", "InputPath": "$", "ResultPath": "$.INPUT.BATCH_NUMBER", "Resource": "arn:aws:lambda:us-east-1:541574621075:function:ddb_get_lambda", "Next": "SKIP GET LAMBDA"}, "SKIP GET LAMBDA": {"Type": "Pass", "InputPath": "$", "ResultPath": "$.SKIP_LAMBDA", "Next": "StartParallel"}, "StartParallel": {"Type": "Parallel", "Next": "Completed", "ResultPath": "$.parallelResult", "Branches": [{"StartAt": "SIT_S_ASSET_EMP", "States": {"SIT_S_ASSET_EMP": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_asset_emp", "StringEquals": "Y", "Next": "PASS SIT_S_ASSET_EMP"}], "Default": "LOAD SIT_S_ASSET_EMP"}, "LOAD SIT_S_ASSET_EMP": {"Type": "Task", "ResultPath": "$.SIT_S_ASSET_EMP", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_asset_emp", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_ASSET_EMP_FAILED"}], "Next": "PASS SIT_S_ASSET_EMP"}, "SNS_SIT_S_ASSET_EMP_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_ASSET_EMP Failed!"}, "Next": "SIT_S_ASSET_EMP_ACTIVITY"}, "SIT_S_ASSET_EMP_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_ASSET_EMP_ACTIVITY", "End": true}, "PASS SIT_S_ASSET_EMP": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_SRV_REGN", "States": {"SIT_S_SRV_REGN": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_srv_regn", "StringEquals": "Y", "Next": "PASS SIT_S_SRV_REGN"}], "Default": "LOAD SIT_S_SRV_REGN"}, "LOAD SIT_S_SRV_REGN": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "ResultPath": "$.SIT_S_SRV_REGN", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_srv_regn", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_SRV_REGN_FAILED"}], "Next": "PASS SIT_S_SRV_REGN"}, "SNS_SIT_S_SRV_REGN_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SIT_S_SRV_REGN Failed!"}, "Next": "SIT_S_SRV_REGN_ACTIVITY"}, "SIT_S_SRV_REGN_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_SRV_REGN_ACTIVITY", "End": true}, "PASS SIT_S_SRV_REGN": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_SRV_REGN_ZIP", "States": {"SIT_S_SRV_REGN_ZIP": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_srv_regn_zip", "StringEquals": "Y", "Next": "PASS SIT_S_SRV_REGN_ZIP"}], "Default": "LOAD SIT_S_SRV_REGN_ZIP"}, "LOAD SIT_S_SRV_REGN_ZIP": {"Type": "Task", "ResultPath": "$.SIT_S_SRV_REGN_ZIP", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_srv_regn_zip", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_SRV_REGN_ZIP_FAILED"}], "Next": "PASS SIT_S_SRV_REGN_ZIP"}, "SNS_SIT_S_SRV_REGN_ZIP_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_SRV_REGN_ZIP Failed!"}, "Next": "SIT_S_SRV_REGN_ZIP_ACTIVITY"}, "SIT_S_SRV_REGN_ZIP_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_SRV_REGN_ZIP_ACTIVITY", "End": true}, "PASS SIT_S_SRV_REGN_ZIP": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_CX_SRV_RGN_MOD", "States": {"SIT_CX_SRV_RGN_MOD": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_cx_srv_rgn_mod", "StringEquals": "Y", "Next": "PASS SIT_CX_SRV_RGN_MOD"}], "Default": "LOAD SIT_CX_SRV_RGN_MOD"}, "LOAD SIT_CX_SRV_RGN_MOD": {"Type": "Task", "ResultPath": "$.SIT_CX_SRV_RGN_MOD", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_cx_srv_rgn_mod", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_CX_SRV_RGN_MOD_FAILED"}], "Next": "PASS SIT_CX_SRV_RGN_MOD"}, "SNS_SIT_CX_SRV_RGN_MOD_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_CX_SRV_RGN_MOD Failed!"}, "Next": "SIT_CX_SRV_RGN_MOD_ACTIVITY"}, "SIT_CX_SRV_RGN_MOD_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_CX_SRV_RGN_MOD_ACTIVITY", "End": true}, "PASS SIT_CX_SRV_RGN_MOD": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_CTLG", "States": {"SIT_S_CTLG": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_ctlg", "StringEquals": "Y", "Next": "PASS SIT_S_CTLG"}], "Default": "LOAD SIT_S_CTLG"}, "LOAD SIT_S_CTLG": {"Type": "Task", "ResultPath": "$.SIT_S_CTLG", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_ctlg", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_CTLG_FAILED"}], "Next": "PASS SIT_S_CTLG"}, "SNS_SIT_S_CTLG_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_CTLG Failed!"}, "Next": "SIT_S_CTLG_ACTIVITY"}, "SIT_S_CTLG_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_CTLG_ACTIVITY", "End": true}, "PASS SIT_S_CTLG": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_ENTL_ACT_TYPE", "States": {"SIT_S_ENTL_ACT_TYPE": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_entl_act_type", "StringEquals": "Y", "Next": "PASS SIT_S_ENTL_ACT_TYPE"}], "Default": "LOAD SIT_S_ENTL_ACT_TYPE"}, "LOAD SIT_S_ENTL_ACT_TYPE": {"Type": "Task", "ResultPath": "$.SIT_S_ENTL_ACT_TYPE", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_entl_act_type", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_ENTL_ACT_TYPE_FAILED"}], "Next": "PASS SIT_S_ENTL_ACT_TYPE"}, "SNS_SIT_S_ENTL_ACT_TYPE_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_ENTL_ACT_TYPE Failed!"}, "Next": "SIT_S_ENTL_ACT_TYPE_ACTIVITY"}, "SIT_S_ENTL_ACT_TYPE_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_ENTL_ACT_TYPE_ACTIVITY", "End": true}, "PASS SIT_S_ENTL_ACT_TYPE": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_SCHED_CAL", "States": {"SIT_S_SCHED_CAL": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_sched_cal", "StringEquals": "Y", "Next": "PASS SIT_S_SCHED_CAL"}], "Default": "LOAD SIT_S_SCHED_CAL"}, "LOAD SIT_S_SCHED_CAL": {"Type": "Task", "ResultPath": "$.SIT_S_SCHED_CAL", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_sched_cal", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_SCHED_CAL_FAILED"}], "Next": "PASS SIT_S_SCHED_CAL"}, "SNS_SIT_S_SCHED_CAL_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_SCHED_CAL Failed!"}, "Next": "SIT_S_SCHED_CAL_ACTIVITY"}, "SIT_S_SCHED_CAL_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_SCHED_CAL_ACTIVITY", "End": true}, "PASS SIT_S_SCHED_CAL": {"Type": "Pass", "End": true}}}, {"StartAt": "SIT_S_SCHED_CAL_HRS", "States": {"SIT_S_SCHED_CAL_HRS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_sit_s_sched_cal_hrs", "StringEquals": "Y", "Next": "PASS SIT_S_SCHED_CAL_HRS"}], "Default": "LOAD SIT_S_SCHED_CAL_HRS"}, "LOAD SIT_S_SCHED_CAL_HRS": {"Type": "Task", "ResultPath": "$.SIT_S_SCHED_CAL_HRS", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_sit_s_sched_cal_hrs", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_SIT_S_SCHED_CAL_HRS_FAILED"}], "Next": "PASS SIT_S_SCHED_CAL_HRS"}, "SNS_SIT_S_SCHED_CAL_HRS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_SIT_S_SCHED_CAL_HRS Failed!"}, "Next": "SIT_S_SCHED_CAL_HRS_ACTIVITY"}, "SIT_S_SCHED_CAL_HRS_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_SIT_S_SCHED_CAL_HRS_ACTIVITY", "End": true}, "PASS SIT_S_SCHED_CAL_HRS": {"Type": "Pass", "End": true}}}]}, "Completed": {"Type": "Pass", "InputPath": "$.SKIP_LAMBDA", "Next": "SNS_SIT_COMPACTION_SUCCESS"}, "SNS_SIT_COMPACTION_SUCCESS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.snsResult", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for COMPACTION_SIT completed successfully!!"}}, "End": true}}}