{"StartAt": "START CD_ENTITY_ONE_TIME_INSERT SCHEDULE", "States": {"START CD_ENTITY_ONE_TIME_INSERT SCHEDULE": {"Type": "Pass", "InputPath": "$", "OutputPath": "$", "Next": "CAPS_SR_FLAT_FILE_INSERT"}, "CAPS_SR_FLAT_FILE_INSERT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.CAPS_SR_FLAT_FILE_INSERT", "StringEquals": "Y", "Next": "PASS CAPS_SR_FLAT_FILE_INSERT"}], "Default": "LOAD CAPS_SR_FLAT_FILE_INSERT"}, "LOAD CAPS_SR_FLAT_FILE_INSERT": {"Type": "Task", "InputPath": "$", "ResultPath": "$.CAPS_SR_FLAT_FILE_INSERT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_otl_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_compaction_sp.sp_caps_sr_flat_file_insert", "--s3path": "s3://odp-us-prod-ent-raw/flat_file/caps_sr/year=2020/month=03/day=09/CAPS_SR_2014to2016.txt", "--aws_secret": "us-prod-odp-compaction-fsso", "--arn": "arn:aws:iam::245792935030:role/ODP-US-Prod-AWSServiceRole", "--region": "us-east-1"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_CAPS_SR_FLAT_FILE_INSERT_FAILED"}], "Next": "PASS CAPS_SR_FLAT_FILE_INSERT"}, "SNS_CAPS_SR_FLAT_FILE_INSERT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:245792935030:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS GLUE SHELL JOB FOR CAPS_SR_FLAT_FILE_INSERT FAILED!"}, "End": false}, "PASS CAPS_SR_FLAT_FILE_INSERT": {"Type": "Pass", "Next": "LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT"}, "LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT", "StringEquals": "Y", "Next": "PASS LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT"}], "Default": "LOAD LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT"}, "LOAD LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT": {"Type": "Task", "InputPath": "$", "ResultPath": "$.LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_otl_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_compaction_sp.sp_la_ib_report_consolidated_flat_file_insert", "--s3path": "s3://odp-us-prod-ent-raw/flat_file/la_ib_report_consolidated/la_ib_report_consolidated.csv", "--aws_secret": "us-prod-odp-compaction-fsso", "--arn": "arn:aws:iam::245792935030:role/ODP-US-Prod-AWSServiceRole", "--region": "us-east-1"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT_FAILED"}], "Next": "PASS LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT"}, "SNS_LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:245792935030:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS GLUE SHELL JOB FOR LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT FAILED!"}, "End": false}, "PASS LA_IB_REPORT_CONSOLIDATED_FLAT_FILE_INSERT": {"Type": "Pass", "Next": "CAPS_SALES_FLAT_FILE_INSERT"}, "CAPS_SALES_FLAT_FILE_INSERT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.CAPS_SALES_FLAT_FILE_INSERT", "StringEquals": "Y", "Next": "PASS CAPS_SALES_FLAT_FILE_INSERT"}], "Default": "LOAD CAPS_SALES_FLAT_FILE_INSERT"}, "LOAD CAPS_SALES_FLAT_FILE_INSERT": {"Type": "Task", "InputPath": "$", "ResultPath": "$.CAPS_SALES_FLAT_FILE_INSERT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_otl_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_compaction_sp.sp_caps_sales_flat_file_insert", "--s3path": "s3://odp-us-prod-ent-raw/flat_file/caps_sales/year=2020/month=04/day=23/CAPS_Sales_2014to2016.txt", "--aws_secret": "us-prod-odp-compaction-fsso", "--arn": "arn:aws:iam::245792935030:role/ODP-US-Prod-AWSServiceRole", "--region": "us-east-1"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_CAPS_SALES_FLAT_FILE_INSERT_FAILED"}], "Next": "PASS CAPS_SALES_FLAT_FILE_INSERT"}, "SNS_CAPS_SALES_FLAT_FILE_INSERT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:245792935030:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS GLUE SHELL JOB FOR CAPS_SALES_FLAT_FILE_INSERT FAILED!"}, "End": false}, "PASS CAPS_SALES_FLAT_FILE_INSERT": {"Type": "Pass", "Next": "CAPS_SR_PARTS_FLAT_FILE_INSERT"}, "CAPS_SR_PARTS_FLAT_FILE_INSERT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.CAPS_SR_PARTS_FLAT_FILE_INSERT", "StringEquals": "Y", "Next": "PASS CAPS_SR_PARTS_FLAT_FILE_INSERT"}], "Default": "LOAD CAPS_SR_PARTS_FLAT_FILE_INSERT"}, "LOAD CAPS_SR_PARTS_FLAT_FILE_INSERT": {"Type": "Task", "InputPath": "$", "ResultPath": "$.CAPS_SR_PARTS_FLAT_FILE_INSERT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_otl_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_compaction_sp.sp_caps_sr_parts_flat_file_insert", "--s3path": "s3://odp-us-prod-ent-raw/flat_file/caps_sr_parts/year=2020/month=03/day=09/CAPS_SR_Parts_2014to2016.txt", "--aws_secret": "us-prod-odp-compaction-fsso", "--arn": "arn:aws:iam::245792935030:role/ODP-US-Prod-AWSServiceRole", "--region": "us-east-1"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_CAPS_SR_PARTS_FLAT_FILE_INSERT_FAILED"}], "Next": "PASS CAPS_SR_PARTS_FLAT_FILE_INSERT"}, "SNS_CAPS_SR_PARTS_FLAT_FILE_INSERT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:245792935030:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS GLUE SHELL JOB FOR CAPS_SR_PARTS_FLAT_FILE_INSERT FAILED!"}, "End": false}, "PASS CAPS_SR_PARTS_FLAT_FILE_INSERT": {"Type": "Pass", "Next": "LUT_EU_GEO_DATA_PARTS_FILES_INSERT"}, "LUT_EU_GEO_DATA_PARTS_FILES_INSERT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.LUT_EU_GEO_DATA_PARTS_FILES_INSERT", "StringEquals": "Y", "Next": "PASS LUT_EU_GEO_DATA_PARTS_FILES_INSERT"}], "Default": "LOAD LUT_EU_GEO_DATA_PARTS_FILES_INSERT"}, "LOAD LUT_EU_GEO_DATA_PARTS_FILES_INSERT": {"Type": "Task", "InputPath": "$", "ResultPath": "$.LUT_EU_GEO_DATA_PARTS_FILES_INSERT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_mrr_otl_rs_proc", "Arguments": {"--rs_proc_name": "hdl_services_compaction_sp.sp_lut_eu_geo_data_parts_files_insert", "--s3path": "s3://odp-us-prod-ent-raw/mirror/parts_files/lut_eu_geo_data/batch=1/", "--aws_secret": "us-prod-odp-compaction-fsso", "--arn": "arn:aws:iam::245792935030:role/ODP-US-Prod-AWSServiceRole", "--region": "us-east-1"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_LUT_EU_GEO_DATA_PARTS_FILES_INSERT_FAILED"}], "Next": "PASS LUT_EU_GEO_DATA_PARTS_FILES_INSERT"}, "SNS_LUT_EU_GEO_DATA_PARTS_FILES_INSERT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:245792935030:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": "AWS GLUE SHELL JOB FOR LUT_EU_GEO_DATA_PARTS_FILES_INSERT FAILED!"}, "End": false}, "PASS LUT_EU_GEO_DATA_PARTS_FILES_INSERT": {"Type": "Pass", "Next": "Completed"}, "Completed": {"Type": "Pass", "Next": "SNS_CD_ENTITY_ONE_TIME_INSERT_SUCCESS"}, "SNS_CD_ENTITY_ONE_TIME_INSERT_SUCCESS": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:245792935030:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for CD_ENTITY_ONE_TIME_INSERT completed successfully!!"}}, "End": true}}}