{"StartAt": "START BF_EDHR_CS COMPACTION JOBS", "States": {"START BF_EDHR_CS COMPACTION JOBS": {"Type": "Pass", "InputPath": "$", "ResultPath": "$", "Next": "GET LAMBDA"}, "GET LAMBDA": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GET_LAMBDA", "StringEquals": "Y", "Next": "SKIP GET LAMBDA"}], "Default": "EXECUTE GET LAMBDA"}, "EXECUTE GET LAMBDA": {"Type": "Task", "InputPath": "$", "ResultPath": "$.INPUT.BATCH_NUMBER", "Resource": "arn:aws:lambda:us-east-1:541574621075:function:ddb_get_lambda", "Next": "SKIP GET LAMBDA"}, "SKIP GET LAMBDA": {"Type": "Pass", "InputPath": "$", "ResultPath": "$.SKIP_LAMBDA", "Next": "StartParallel"}, "StartParallel": {"Type": "Parallel", "Next": "Completed", "ResultPath": "$.parallelResult", "Branches": [{"StartAt": "CONSUMED_PART", "States": {"CONSUMED_PART": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_consumed_part", "StringEquals": "Y", "Next": "PASS CONSUMED_PART"}], "Default": "LOAD CONSUMED_PART"}, "LOAD CONSUMED_PART": {"Type": "Task", "ResultPath": "$.CONSUMED_PART", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_consumed_part", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_CONSUMED_PART_FAILED"}], "Next": "PASS CONSUMED_PART"}, "SNS_CONSUMED_PART_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_CONSUMED_PART Failed!"}, "Next": "CONSUMED_PART_ACTIVITY"}, "CONSUMED_PART_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_CONSUMED_PART_ACTIVITY", "End": true}, "PASS CONSUMED_PART": {"Type": "Pass", "End": true}}}, {"StartAt": "UDA_UNIT", "States": {"UDA_UNIT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_uda_unit", "StringEquals": "Y", "Next": "PASS UDA_UNIT"}], "Default": "LOAD UDA_UNIT"}, "LOAD UDA_UNIT": {"Type": "Task", "ResultPath": "$.UDA_UNIT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_uda_unit", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_UDA_UNIT_FAILED"}], "Next": "PASS UDA_UNIT"}, "SNS_UDA_UNIT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_UDA_UNIT Failed!"}, "Next": "UDA_UNIT_ACTIVITY"}, "UDA_UNIT_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_UDA_UNIT_ACTIVITY", "End": true}, "PASS UDA_UNIT": {"Type": "Pass", "End": true}}}, {"StartAt": "UDA_PART", "States": {"UDA_PART": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_uda_part", "StringEquals": "Y", "Next": "PASS UDA_PART"}], "Default": "LOAD UDA_PART"}, "LOAD UDA_PART": {"Type": "Task", "ResultPath": "$.UDA_PART", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_uda_part", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_UDA_PART_FAILED"}], "Next": "PASS UDA_PART"}, "SNS_UDA_PART_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_UDA_PART Failed!"}, "Next": "UDA_PART_ACTIVITY"}, "UDA_PART_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_UDA_PART_ACTIVITY", "End": true}, "PASS UDA_PART": {"Type": "Pass", "End": true}}}, {"StartAt": "UDA_LOT", "States": {"UDA_LOT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_uda_lot", "StringEquals": "Y", "Next": "PASS UDA_LOT"}], "Default": "LOAD UDA_LOT"}, "LOAD UDA_LOT": {"Type": "Task", "ResultPath": "$.UDA_LOT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_uda_lot", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_UDA_LOT_FAILED"}], "Next": "PASS UDA_LOT"}, "SNS_UDA_LOT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_UDA_LOT Failed!"}, "Next": "UDA_LOT_ACTIVITY"}, "UDA_LOT_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_UDA_LOT_ACTIVITY", "End": true}, "PASS UDA_LOT": {"Type": "Pass", "End": true}}}, {"StartAt": "PART", "States": {"PART": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_part", "StringEquals": "Y", "Next": "PASS PART"}], "Default": "LOAD PART"}, "LOAD PART": {"Type": "Task", "ResultPath": "$.PART", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_part", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_PART_FAILED"}], "Next": "PASS PART"}, "SNS_PART_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_PART Failed!"}, "Next": "PART_ACTIVITY"}, "PART_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_PART_ACTIVITY", "End": true}, "PASS PART": {"Type": "Pass", "End": true}}}, {"StartAt": "UNIT", "States": {"UNIT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_unit", "StringEquals": "Y", "Next": "PASS UNIT"}], "Default": "LOAD UNIT"}, "LOAD UNIT": {"Type": "Task", "ResultPath": "$.UNIT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_unit", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_UNIT_FAILED"}], "Next": "PASS UNIT"}, "SNS_UNIT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_UNIT Failed!"}, "Next": "UNIT_ACTIVITY"}, "UNIT_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_UNIT_ACTIVITY", "End": true}, "PASS UNIT": {"Type": "Pass", "End": true}}}, {"StartAt": "LOT", "States": {"LOT": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_lot", "StringEquals": "Y", "Next": "PASS LOT"}], "Default": "LOAD LOT"}, "LOAD LOT": {"Type": "Task", "ResultPath": "$.LOT", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_incr_refresh_ov_bf_edhr_cs_lot", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_LOT_FAILED"}], "Next": "PASS LOT"}, "SNS_LOT_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for SNS_LOT Failed!"}, "Next": "LOT_ACTIVITY"}, "LOT_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_LOT_ACTIVITY", "End": true}, "PASS LOT": {"Type": "Pass", "End": true}}}]}, "Completed": {"Type": "Pass", "InputPath": "$.SKIP_LAMBDA", "Next": "SNS_BF_EDHR_CS_COMPACTION_SUCCESS"}, "SNS_BF_EDHR_CS_COMPACTION_SUCCESS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.snsResult", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for IB_INTEL_BF_EDHR_CS COMPACTION1 completed successfully!!"}}, "End": true}}}