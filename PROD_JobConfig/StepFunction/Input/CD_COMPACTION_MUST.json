{"StartAt": "START MUST COMPACTION JOBS", "States": {"START MUST COMPACTION JOBS": {"Type": "Pass", "InputPath": "$", "ResultPath": "$", "Next": "GET LAMBDA"}, "GET LAMBDA": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.GET_LAMBDA", "StringEquals": "Y", "Next": "SKIP GET LAMBDA"}], "Default": "EXECUTE GET LAMBDA"}, "EXECUTE GET LAMBDA": {"Type": "Task", "InputPath": "$", "ResultPath": "$.INPUT.BATCH_NUMBER", "Resource": "arn:aws:lambda:us-east-1:541574621075:function:ddb_get_lambda", "Next": "SKIP GET LAMBDA"}, "SKIP GET LAMBDA": {"Type": "Pass", "InputPath": "$", "ResultPath": "$.SKIP_LAMBDA", "Next": "StartParallel"}, "StartParallel": {"Type": "Parallel", "Next": "Completed", "ResultPath": "$.parallelResult", "Branches": [{"StartAt": "MUST_SITE", "States": {"MUST_SITE": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_full_refresh_must_site", "StringEquals": "Y", "Next": "PASS MUST_SITE"}], "Default": "LOAD MUST_SITE"}, "LOAD MUST_SITE": {"Type": "Task", "ResultPath": "$.MUST_SITE", "Resource": "arn:aws:states:::glue:startJobRun.sync", "Parameters": {"JobName": "job_lnd_mrr_full_refresh_must_site", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_MUST_SITE_FAILED"}], "Next": "PASS MUST_SITE"}, "SNS_MUST_SITE_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for MUST_SITE Failed!"}, "Next": "MUST_SITE_ACTIVITY"}, "MUST_SITE_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_MUST_SITE_ACTIVITY", "End": true}, "PASS MUST_SITE": {"Type": "Pass", "End": true}}}, {"StartAt": "MUST_SYST", "States": {"MUST_SYST": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_full_refresh_must_syst", "StringEquals": "Y", "Next": "PASS MUST_SYST"}], "Default": "LOAD MUST_SYST"}, "LOAD MUST_SYST": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "InputPath": "$", "OutputPath": "$", "ResultPath": "$.MUST_SYST", "Parameters": {"JobName": "job_lnd_mrr_full_refresh_must_syst", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_MUST_SYST_FAILED"}], "Next": "PASS MUST_SYST"}, "SNS_MUST_SYST_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for MUST_SYST Failed!"}, "Next": "MUST_SYST_ACTIVITY"}, "MUST_SYST_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_MUST_SYST_ACTIVITY", "End": true}, "PASS MUST_SYST": {"Type": "Pass", "End": true}}}, {"StartAt": "MUST_CUST_ACC", "States": {"MUST_CUST_ACC": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_full_refresh_must_cust_acc", "StringEquals": "Y", "Next": "PASS MUST_CUST_ACC"}], "Default": "LOAD MUST_CUST_ACC"}, "LOAD MUST_CUST_ACC": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "InputPath": "$", "OutputPath": "$", "ResultPath": "$.MUST_CUST_ACC", "Parameters": {"JobName": "job_lnd_mrr_full_refresh_must_cust_acc", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_MUST_CUST_ACC_FAILED"}], "Next": "PASS MUST_CUST_ACC"}, "SNS_MUST_CUST_ACC_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for MUST_CUST_ACC Failed!"}, "Next": "MUST_CUST_ACC_ACTIVITY"}, "MUST_CUST_ACC_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_MUST_CUST_ACC_ACTIVITY", "End": true}, "PASS MUST_CUST_ACC": {"Type": "Pass", "End": true}}}, {"StartAt": "MUST_FSE", "States": {"MUST_FSE": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_full_refresh_must_fse", "StringEquals": "Y", "Next": "PASS MUST_FSE"}], "Default": "LOAD MUST_FSE"}, "LOAD MUST_FSE": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "InputPath": "$", "OutputPath": "$", "ResultPath": "$.MUST_FSE", "Parameters": {"JobName": "job_lnd_mrr_full_refresh_must_fse", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_MUST_FSE_FAILED"}], "Next": "PASS MUST_FSE"}, "SNS_MUST_FSE_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for MUST_FSE Failed!"}, "Next": "MUST_FSE_ACTIVITY"}, "MUST_FSE_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_MUST_FSE_ACTIVITY", "End": true}, "PASS MUST_FSE": {"Type": "Pass", "End": true}}}, {"StartAt": "MUST_TAB003UK", "States": {"MUST_TAB003UK": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_full_refresh_must_tab003uk", "StringEquals": "Y", "Next": "PASS MUST_TAB003UK"}], "Default": "LOAD MUST_TAB003UK"}, "LOAD MUST_TAB003UK": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "InputPath": "$", "OutputPath": "$", "ResultPath": "$.MUST_TAB003UK", "Parameters": {"JobName": "job_lnd_mrr_full_refresh_must_tab003uk", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_MUST_TAB003UK_FAILED"}], "Next": "PASS MUST_TAB003UK"}, "SNS_MUST_TAB003UK_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for MUST_TAB003UK Failed!"}, "Next": "MUST_TAB003UK_ACTIVITY"}, "MUST_TAB003UK_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_MUST_TAB003UK_ACTIVITY", "End": true}, "PASS MUST_TAB003UK": {"Type": "Pass", "End": true}}}, {"StartAt": "MUST_PARTS", "States": {"MUST_PARTS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_full_refresh_must_parts", "StringEquals": "Y", "Next": "PASS MUST_PARTS"}], "Default": "LOAD MUST_PARTS"}, "LOAD MUST_PARTS": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "InputPath": "$", "OutputPath": "$", "ResultPath": "$.MUST_PARTS", "Parameters": {"JobName": "job_lnd_mrr_full_refresh_must_parts", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_MUST_PARTS_FAILED"}], "Next": "PASS MUST_PARTS"}, "SNS_MUST_PARTS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for MUST_PARTS Failed!"}, "Next": "MUST_PARTS_ACTIVITY"}, "MUST_PARTS_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_MUST_PARTS_ACTIVITY", "End": true}, "PASS MUST_PARTS": {"Type": "Pass", "End": true}}}, {"StartAt": "MUST_CONTHRS", "States": {"MUST_CONTHRS": {"Type": "Choice", "Choices": [{"Variable": "$.INPUT.job_lnd_mrr_full_refresh_must_conthrs", "StringEquals": "Y", "Next": "PASS MUST_CONTHRS"}], "Default": "LOAD MUST_CONTHRS"}, "LOAD MUST_CONTHRS": {"Type": "Task", "Resource": "arn:aws:states:::glue:startJobRun.sync", "InputPath": "$", "OutputPath": "$", "ResultPath": "$.MUST_CONTHRS", "Parameters": {"JobName": "job_lnd_mrr_full_refresh_must_conthrs", "Arguments": {"--batch_number.$": "$.INPUT.BATCH_NUMBER"}}, "Retry": [{"ErrorEquals": ["States.Timeout"], "MaxAttempts": 3, "IntervalSeconds": 60, "BackoffRate": 2}], "Catch": [{"ErrorEquals": ["States.TaskFailed"], "Next": "SNS_MUST_CONTHRS_FAILED"}], "Next": "PASS MUST_CONTHRS"}, "SNS_MUST_CONTHRS_FAILED": {"Type": "Task", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_FAILURE", "Message.$": "$.Cause", "Subject": " AWS Glue job for MUST_CONTHRS Failed!"}, "Next": "MUST_CONTHRS_ACTIVITY"}, "MUST_CONTHRS_ACTIVITY": {"Type": "Task", "Resource": "arn:aws:states:us-east-1:541574621075:activity:COMPACTION_MUST_CONTHRS_ACTIVITY", "End": true}, "PASS MUST_CONTHRS": {"Type": "Pass", "End": true}}}]}, "Completed": {"Type": "Pass", "InputPath": "$.SKIP_LAMBDA", "Next": "SNS_MUST_COMPACTION_SUCCESS"}, "SNS_MUST_COMPACTION_SUCCESS": {"Type": "Task", "InputPath": "$", "ResultPath": "$.snsResult", "Resource": "arn:aws:states:::sns:publish", "Parameters": {"TopicArn": "arn:aws:sns:us-east-1:541574621075:ODP_SFN_SUCCESS", "Message": {"Subject": "AWS Step function for CD_COMPACTION_MUST completed successfully!!"}}, "End": true}}}